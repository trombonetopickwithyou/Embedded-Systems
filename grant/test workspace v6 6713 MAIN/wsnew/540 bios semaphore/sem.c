//-----------------------------------------------------------------------
#include "semaphorecfg.h"
#include "dsk6713_dip.h"
#include "dsk6713_led.h"
#include "dsk6713.h"
#include <swi.h>
#include <sem.h>

//-----------------------------------------------------------------------
void init(void);
//-----------------------------------------------------------------------

//-----------------------------------------------------------------------
void main(void)
{
	init();
}
//-----------------------------------------------------------------------


//-----------------------------------------------------------------------
void init(void)
{
	DSK6713_init();                   	//call BSL to init DSK-EMIF,PLL)
	CSL_init();
	DSK6713_LED_init();  				//init LEDs
	DSK6713_DIP_init();                 //init DIP SWs
	
} // init
//-----------------------------------------------------------------------


//-----------------------------------------------------------------------
void PRD0_ftn(int arg0, int arg1)
{
	SWI_post(&SWI0);
} // PRD0_ftn
//-----------------------------------------------------------------------


//-----------------------------------------------------------------------
void SWI0_ftn(int arg0, int arg1)
{
	  if(DSK6713_DIP_get(0)==0)         // SW0 is down
	  	DSK6713_LED_off(0);
	  else if(DSK6713_DIP_get(1)==0)         // SW1 is down
	  	DSK6713_LED_off(1);
	  else if(DSK6713_DIP_get(2)==0)         // SW2 is down
	  	DSK6713_LED_off(2);
	  else if(DSK6713_DIP_get(3)==0)         // SW3 is down
	  	DSK6713_LED_off(3);
	  else
	    SEM_postBinary(&SEM0);
	
} // SWI0_ftn
//-----------------------------------------------------------------------


//-----------------------------------------------------------------------
void TSK0_ftn(int arg0, int arg1)
{
	for(;;)
	  {
	  	SEM_pendBinary(&SEM0, SYS_FOREVER);
	  	DSK6713_LED_on(0);
	  }
}// TSK0_ftn
//-----------------------------------------------------------------------


//-----------------------------------------------------------------------
void TSK1_ftn(int arg0, int arg1)
{
	for(;;)
	  {
	  	SEM_pendBinary(&SEM0, SYS_FOREVER);
	  	DSK6713_LED_on(1);
	  }
	
}// TSK1_ftn
//-----------------------------------------------------------------------


//-----------------------------------------------------------------------
void TSK2_ftn(int arg0, int arg1)
{
	for(;;)
	  {
	  	SEM_pendBinary(&SEM0, SYS_FOREVER);
	  	DSK6713_LED_on(2);
	  }
	
}// TSK2_ftn
//-----------------------------------------------------------------------


//-----------------------------------------------------------------------
void TSK3_ftn(int arg0, int arg1)
{
	for(;;)
	  {
	  	SEM_pendBinary(&SEM0, SYS_FOREVER);
	  	DSK6713_LED_on(3);
	  }
	
} // TSK3_ftn
//-----------------------------------------------------------------------

