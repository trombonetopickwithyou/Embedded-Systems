//-------------------------------------------------------------------
#include "dsk6713.h"
#include "dsk6713_dip.h"
#include "dsk6713_led.h"
#include "mbcfg.h"
#include <mbx.h>
//-------------------------------------------------------------------

//-------------------------------------------------------------------
void init(void);
//-------------------------------------------------------------------


//-------------------------------------------------------------------
void main(void)
{
	init();
	
} // main
//-------------------------------------------------------------------


//-------------------------------------------------------------------
void init(void)
{
	DSK6713_init();
	CSL_init();
	DSK6713_DIP_init();
	DSK6713_LED_init();


	
} // init
//-------------------------------------------------------------------


//-------------------------------------------------------------------
void PRD0_ftn(int arg0, int arg1)
{
	int status;
	int j;
	j = *(volatile unsigned char *) DSK6713_CPLD_BASE;
	j = j >> 4;
	j = j & 0xF;
	
	if(j & 0x8)
	  status = MBX_post(&MBX0, &j, 0);
	else
	  status = MBX_post(&MBX1, &j, 0);
} // PRD0_ftn
//-------------------------------------------------------------------

//-------------------------------------------------------------------
void TSK0_ftn(int arg0, int arg1)
{
	int k;
	int status;
	
	for(;;) // ever
	  {
	  	status = MBX_pend(&MBX0, &k, SYS_FOREVER);
	  	DSK6713_LED_off(k & 0x3);
	  	
	  }
} // TSK0_ftn
//-------------------------------------------------------------------

//-------------------------------------------------------------------
void TSK1_ftn(int arg0, int arg1)
{
	int k;
	int status;
	for(;;) // ever
	  {
	  	status = MBX_pend(&MBX1, &k, SYS_FOREVER);
	  	DSK6713_LED_on(k & 3);
	  	
	  }
} // TSK1_ftn
//-------------------------------------------------------------------


